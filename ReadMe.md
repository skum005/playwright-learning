# Playwright Learning using Javascript/TypeScript

## Table of Contents
- [Installation](#installation)
- [Run sample tests](#run-sample-tests)
- [Debugging](#debugging-code)

## Installation

- Install Node.js on your machine
- Install Visual Studio Code IDE 
- Open Visual Studio Code & Install **Playwright Test for VSCode** extension by Microsoft 
- Create an empty folder and open the same in Visual Studio Code 
- In the VS Code terminal run the command npm init playwright@latest & follow the on-screen instructions

## Run sample tests

- To run sample tests(that were generated by Playwright during installation), use the below command

    ``` npx playwright test ```

The tests would be executed in the browsers that were configured in **playwright.config.js**. Refer the screenshot below for browser configuration

![BrowsersConfiguration](/documentation/images/browsers-config.png)

- To display the test report use the below command 

    ```npx playwright show-report```

- To run tests in a specific browser

    ```npx playwright test --project=chromium```

- By default tests run in headless mode however if you would like to run tests in UI mode **--headed** flag can be added to you command. Example below 

    ```npx playwright test --project=chromium --headed```

- To run tests of a single specific spec file, mention the name of the spec file in the command(right next to **test** in the command). Example below 

    ```npx playwright test example.spec.js --project=chromium --headed```

- To run a specific test use the -g option followed by the name of the test. Example below

    ```npx playwright test -g "has title" --project=chromium --headed```

- To skip a test use **test.skip** and to run only one test use **test.only**

- To open Playwright UI runner(helps in debugging/running tests during script development), use the command below

    ```npx playwright test --ui```

### Playwright UI

![PlaywrightUI](/documentation/images/playwright-ui.png)

## Debugging Code

There are three methods you can debug your code. 

### Method 1 - Tracing 

You can generate a tracing and add it to the test report using the flag *--trace on*. Example below

```npx playwright test --project=chromium --trace on```

This generates a folder playwright-report where a report is saved in index.html file. The full trace of the execution is saved under this report . Please note that this report needs to be opened using http/https protocols not as a file. Use the below command to open the report 

```npx playwright show-report <path of the plawright-report>```

### Method 2 - Use playwright debugger

You can activate playwright debugger using the debug flag. Example below command below. The playwright debugger opens in a new window where you are provided with various debug options

```npx playwright test -g "<name of the test>" --project=chromium --debug```

### Method 3 - VS Code Playwright Debugger

This requires the VS Code extension - "Playwright Test for VSCode"(covered in installation topic). Once this extension is installed, you will see the *Testing*(Conical Flask) option in VS Code. Click on the Testing icon and you will see debug option for every test. 

Steps to debug 

    1. Open the spec file where your test is present
    2. Introduce a debug point as per your need
    3. Click on debug options present against the spec file

## Finding elements

### User facing locators 

Consider an example where there a button a web page with text Sign In and for the same you have created a web element using the id or some other attribute name. The script works perfectly fine here however we may end up comprisming the actual validation which is validating the existence of a button with text 'Sign In'. And the reason the locator doesn't care the important details of the button instead it focuses on implementation details(by using id, name, class) which user doesn't know about. Hence it is important to create locators with user facing details as much as possible

- [Example test with user facing locators](tests/user-facing-locators.spec.js)
- [Finding Child Elements](tests/child-elements.spec.js)

## Assertions

Refer the sample test file with the examples of various types of assertions

[Assertions Example](tests/assertions.spec.js)

## Waiting

Refer the sample test file with wait examples

[Waiting Examples](tests/waiting.spec.js)

## Timeouts 

There are different types of timouts in playwright. 

1. Global Timeout : Maximum time that the whole pack can take to execute. If it total execution time crosses this time, the test execution would be aborted. This can be configured in the [playwright.config.js](playwright.config.js) file using the variable **globalTimeout** at the root level. 

2. Test timeout: Maximum time that a single test can take to execute. This can be configured in the [playwright.config.js](playwright.config.js) file and also at the individual test level. Default value is 30000 ms.

Global timeout and test timeout configuration:

```
timeout: 500000,
globalTimeout : 1800000,
```

3. Test timeout has 3 child timeouts. 

- **Action timeout**: timeout for completing actions on element. E.g. click(), fill(). Can be configured in **use** section of the playwright.config.js file.  
- **Navigation timeout**: timeout for completing navigation. E.g. page.goto(). Can be configured in **use** section of the playwright.config.js file.  

![Timeouts Configuration for actions and navigation](documentation/test-timeouts.png)

- **Locator assertion timeout**: timeout for completing locator assertions. Default value is 5000 ms

```
expect : {
    timeout : 10000
  }
```

Few code snippets of timeout examples are saved in this file -> [Timeout Examples](tests/timeouts.spec.js) 

## Interacting with elements

### Extracting values - text, attribute values, properties

Refer the sample test file with the examples of how to extract values from elements 

[Extract values](tests/extracting-values.spec.js)

### Input fields

[Example test for input fields](tests/input-fields.spec.js)

### Radio buttons

[Example test for radio buttons](tests/radio.spec.js)

### Check boxes

[Example test for check boxes](tests/checkboxes.spec.js)

### Mouse Hover 

[Example test to invoke mouse hover](tests/hover.spec.js)

### Tables example

[Interacting with table example](tests/tables.spec.js)

### Working with dialog boxes

[Example test for interacting with dialog boxes](tests/dialogboxes.spec.js)

### Updating element attributes

[Example test for demo attribute update](tests/update.attrib.spec.js)


## Parallel execution configuration

Local execution - By default Playwright creates a worker(instance of a browser) for each spec file. All spec files are executed in parallel but the tests inside the spec files are executed in serial inside the same worker. 

### Default configuration is below. Meaning of the below config is 

- 1 worker only for all the spec when executed in CI
- 1 worker per spec when executed in local
- fullyParallel is false represents do not execute tests inside the spec files in parallel

```
workers: process.env.CI ? 1 : undefined,
fullyParallel: false,
```

Here are the different settings to modify parallel execution set up

### Execute tests inside specs in parallel

- change fullyParallel to true

```
workers: process.env.CI ? 1 : undefined,
fullyParallel: true,
```

### Execute all specs & tests in serial

- change fully parallel to false
- set number of workers to 1

```
workers: process.env.CI ? 1 : 1,
fullyParallel: false,
```

### Changing the order of execution during parallel execution

By default Playwright executes tests in random order, however if you would like to define the execution order, change the prefix of spec file names to numbers like 001, 002, 003 etc.  e.g. 001-hover.spec.js

### Execute specific tests(under a describe block) in specific spec files in parallel and remaining in serial

This change needs to be done in a spec file. [Here is the example](./tests/describe.spec.js)

### Execute all tests in specific spec files in parallel and remaining in serial

Below configuration needs to be added to the spec file 

```
test.describe.configure({mode: 'parallel'})
```

### To create test dependency - executing specific tests in serial

Inside the describe block create a configuration to execute tests in serial. Example below

```
test.describe('All search tests', () => {
    test.describe.configure({mode: 'serial'})
    test('Basic search', async({page}) => {
        const searchBtn = page.locator('textarea[title="Search"]')
        await searchBtn.fill('Playwright')
        const title = await page.title()
        expect(title).toEqual('Google')
    })

    test('About link', async({page}) => {
        const aboutLink = page.locator('//a[text()="About"]')
        await aboutLink.click()
        const title = await page.title()
        expect(title).toEqual('About Google: Our products, technology and company information - About Google')
    })


})
```

If one of the previous tests in the describe block fails, then the consecutive tests would be skipped as they are dependant

### To execute all tests in spec files in parallel for a specific browser

Use the below configuration to execute the tests in parallel for a specific browser

```
    {
      name: 'chromium',
      use: { ...devices['Desktop Chrome'] },
      fullyParallel : true
    }
```

## Screenshots & Videos

[An example spec file](/tests/screenshots.spec.js) is created to demonstrate the usage of screenshot() method. 

To enable recording of the tests, update the below config playwright.config.js file under **use** object

```
video : 'on'
```

Also video quality settings can also be set. Example below

```
video : {
      mode : 'on',
      size : {
        height : 480,
        width : 640
      }
    }
```